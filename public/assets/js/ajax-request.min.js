function ajaxRequest(){try{var a=new XMLHttpRequest()}catch(d){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){a=false}}}return a}function getActivatedObjected(b){var a;if(!b){a=window.event.srcElement}else{if(b.srcElement){a=b.srcElement}else{a=b.target}}return a}function sendxhr(params,url,restype,method,callback,xhrError){if(typeof(restype)==="undefined"){restype="HTML"}if(typeof(method)==="undefined"){method="POST"}url=(method==="POST")?url:url+"?"+params;var request=new ajaxRequest();request.open(method,url,true);request.setRequestHeader("Content-type","application/x-www-form-urlencoded");request.onerror=function(){if(typeof(xhrError)==="function"){xhrError()}else{if(typeof(__treatXHRError)==="function"){__treatXHRError()}else{alert("oops! seems you are offline, please check your connection and try again... Thanks")}}};request.onreadystatechange=function(){if(this.readyState===4){if(this.status===200){if(this.responseText!==null){var response;if(restype==="JSON"){response=eval("("+this.responseText+")")}else{response=this.responseText}if(typeof(callback)!=="undefined"){callback(response)}}}}};if(method==="POST"){request.send(params)}else{request.send()}}function sendForm(params,url,callback,xhrError){var request=new ajaxRequest();request.open("POST",url,true);request.onerror=function(){if(typeof(xhrError)==="function"){xhrError()}else{if(typeof(__treatXHRError)==="function"){__treatXHRError()}else{alert("oops! seems you are offline, please check your connection and try again... Thanks")}}};request.onreadystatechange=function(){if(this.readyState===4){if(this.status===200){if(this.responseText!==null){var response;response=eval("("+this.responseText+")");if(typeof(callback)!=="undefined"){callback(response)}}}}};request.send(params)};